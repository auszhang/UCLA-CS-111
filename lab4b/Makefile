# NAME: Christopher Aziz
# EMAIL: caziz@ucla.edu

CFLAGS = -Wall -Wextra -lm -lmraa -g
CC = gcc
STUDENT_ID = 000000000

# build executable
build: lab4b

lab4b: lab4b.c
	$(CC) $(CFLAGS) -o $@ $^

# execute an automated smoke-test to see if it runs and can talk to its sensors/actuators
check: clean build check_invalid_option check_invalid_argument

check_invalid_option:
	@./lab4b --bogus > /dev/null 2>&1; \
	if [ $$? -ne 1 ]; then \
		echo "Failed smoke-test: bogus option did not result in exit code 1"; \
		exit 1; \
	fi

check_invalid_argument:
	@./lab4b --scale=bogus > /dev/null 2>&1; \
	if [ $$? -ne 1 ]; then \
		echo "Failed smoke-test: bogus argument did not result in exit code 1"; \
		exit 1; \
	fi

check_valid:
	@./lab4b --scale=C --period=5 --log=smoke_test_logfile > /dev/null 2>&1; \
	if [ $$? -ne 0 ]; then \
		echo "Failed smoke-test: valid options did not result in exit code 0"; \
		exit 1; \
	fi
	@./rm smoke_test_logfile

# delete all programs and output generated by the Makefile
clean:
	rm -rf lab4b *.tar.gz

# build distribution tarball
dist: 
	tar -czvf lab4b-$(STUDENT_ID).tar.gz README lab4b.c Makefile
